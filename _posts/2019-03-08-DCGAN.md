---
title: "DCGAN"
date: 2019-03-08
classes: wide
use_math: true
tags: python keras tensorflow reinforcement_learning machine_learning  GAN DCGAN
category: reinforcement learning
---

## DCGAN  
- refer to github, YBIGTA   
[DCGAN](https://github.com/YBIGTA/Deep_learning/)  

[GAN practice](https://github.com/Jooong/Deep-Learning-Study)


### Generator
![generator](https://dev-strender.github.io/img/posts/DeepLearning/gen-architecture.png)

### Discriminator
![Discriminator](https://dev-strender.github.io/img/posts/DeepLearning/discrim-architecture.png)

[understanding DCGAN ](https://dreamgonfly.github.io/2018/03/17/gan-explained.html)
[code review of DCGAN](https://kim6394.tistory.com/82)

### Convolution  
```python
sess = tf.InteractiveSession()
image = np.array([[[[1],[2],[3]],
                   [[4],[5],[6]], 
                   [[7],[8],[9]]]], dtype=np.float32)
print(image.shape)
plt.imshow(image.reshape(3,3), cmap='Greys')

# print("imag:\n", image)
print("image.shape", image.shape)
weight = tf.constant([[[[1.]],[[1.]]],
                      [[[1.]],[[1.]]]])
print("weight.shape", weight.shape)
conv2d = tf.nn.conv2d(image, weight, strides=[1, 1, 1, 1], padding='VALID')
conv2d_img = conv2d.eval()
print("conv2d_img.shape", conv2d_img.shape)
conv2d_img = np.swapaxes(conv2d_img, 0, 3)
for i, one_img in enumerate(conv2d_img):
    print(one_img.reshape(2,2))
    plt.subplot(1,2,i+1), plt.imshow(one_img.reshape(2,2), cmap='gray')

```



### mnist  
```python
def mnist():
    X, Y = util.get_mnist()
    X = X.reshape(len(X), 28, 28, 1)
    dim = X.shape[1]
    colors = X.shape[-1]

    # for mnist
    d_sizes = {
    'conv_layers': [(2, 5, 2, False), (64, 5, 2, True)],
    'dense_layers': [(1024, True)],
    }
    g_sizes = {
    'z': 100,
    'projection': 128,
    'bn_after_project': False,
    'conv_layers': [(128, 5, 2, True), (colors, 5, 2, False)],
    'dense_layers': [(1024, True)],
    'output_activation': tf.sigmoid,
    }



    gan = DCGAN(dim, colors, d_sizes, g_sizes)
    gan.fit(X)

```

### DCGAN  
```python
self.img_length = img_length  ## 28
self.num_colors = num_colors  ## 1
self.latent_dims = g_sizes['z'] ## 100 

# define the input data
self.X = tf.placeholder( # 28 x 28 x 1
  tf.float32,
  shape=(None, img_length, img_length, num_colors),
  name='X'
)
self.Z = tf.placeholder( # 100 
  tf.float32,
  shape=(None, self.latent_dims),
  name='Z'
)
```

